<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Circular Portal</title>
   <style>
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
    }
    body {
        background-image: url('https://nyatigroup.com/assets/images/Nyati-website-image.jpg'); 
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        overflow: hidden;
    }
    .glass-container {
        background: rgba(255, 255, 255, 0.9);
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        text-align: center;
        width: 380px;
        animation: fadeInUp 0.8s ease-out;
        border: 1px solid rgba(255, 255, 255, 0.3);
        position: relative;
    }
    h2 { 
        color: #333; 
        margin-bottom: 20px; 
        font-weight: 600;
        letter-spacing: 1px;
    }
    .input-group {
        margin-bottom: 20px;
        text-align: left;
    }
    label {
        display: block;
        font-weight: bold;
        margin-bottom: 8px;
        color: #555;
        font-size: 14px;
    }
    select {
        width: 100%;
        padding: 12px;
        border: 2px solid #eee;
        border-radius: 8px;
        font-size: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        background-color: white;
    }
    select:hover { border-color: #007bff; }
    select:focus { outline: none; border-color: #007bff; box-shadow: 0 0 10px rgba(0, 123, 255, 0.2); }
    
    /* --- DEPARTMENT DROP DOWN ICON REMOVAL --- */
    #department {
        background-color: #f8f9fa;
        cursor: default;
        -webkit-appearance: none; /* Icon remove for Chrome/Safari */
        -moz-appearance: none;    /* Icon remove for Firefox */
        appearance: none;         /* Standard icon remove */
        background-image: none !important;
    }

    #searchWrapper {
        position: absolute;
        top: 20px;
        right: 20px;
        display: flex;
        align-items: center;
        background: white;
        border-radius: 20px;
        padding: 5px 10px;
        border: 1px solid #ddd;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        width: 30px;
        height: 30px;
        overflow: hidden;
        z-index: 10;
    }
    .search-active {
        width: 220px !important;
        border-color: #007bff !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    #suggestionList {
        display: none;
        position: absolute;
        top: 60px;
        right: 20px;
        background: white;
        width: 250px;
        border-radius: 8px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        z-index: 1000;
        text-align: left;
        max-height: 200px;
        overflow-y: auto;
        border: 1px solid #eee;
    }
    .suggestion-item {
        padding: 12px;
        cursor: pointer;
        border-bottom: 1px solid #f5f5f5;
        font-size: 13px;
        color: #333;
        transition: 0.2s;
    }
    .suggestion-item:hover {
        background-color: #eef6ff;
        color: #007bff;
        padding-left: 15px;
    }

    /* --- POP-OUT ICON REMOVAL CSS --- */
    .iframe-container {
        position: relative;
        width: 100%;
        height: calc(100% - 50px);
    }
    .iframe-blocker {
        position: absolute;
        top: 0;
        right: 0;
        width: 55px;
        height: 55px;
        background: #202124;
        z-index: 99;
        pointer-events: all;
    }

    @media print {
        body * { visibility: hidden !important; }
        #pdfViewer, #pdfViewer *, #pdfFrame { visibility: visible !important; }
        #pdfViewer { position: fixed !important; left: 0 !important; top: 0 !important; width: 100% !important; height: 100% !important; background: white !important; z-index: 9999999 !important; }
        #pdfFrame { width: 100% !important; height: 100vh !important; border: none !important; }
        .iframe-blocker { display: none !important; }
    }
</style>
</head>
<body>

    <div class="glass-container">
    <div id="searchWrapper">
        <span id="searchIcon" style="cursor: pointer; font-size: 16px;">üîç</span>
        <input type="text" id="floatingSearch" placeholder="Type to search circular..." 
               style="border: none; outline: none; width: 180px; font-size: 13px; margin-left: 10px; display: none;">
    </div>
    <div id="suggestionList"></div>
    <h2>Circular Search</h2>
        
        <div class="input-group">
            <label>Department</label>
            <select id="department" disabled>
                <option value="EPC (Post Tender Department)" selected>EPC (Post Tender Department)</option>
            </select>
        </div>

        <div class="input-group">
            <label>Select Circular</label>
            <select id="circular" onchange="redirectUser()">
                <option value="" disabled selected>--- Choose a Circular ---</option>
                <option value="https://drive.google.com/file/d/1Se5UBj1f2MeiR89QfBPx48mcGyM244IN/view?usp=sharing">Circular No. 01 (EPC & RE) Role and Responsibility_Surveying(1)</option>
                <option value="https://drive.google.com/file/d/1L0uDrzvLEDv6YrdEXjoNQFssA_RuAQds/view?usp=sharing">Circular No. 02 Undertaking of Certification of EPC-MEP Subcontractor's Bill</option>
                <option value="https://drive.google.com/file/d/1brmPoubd2jJM5_ghLsnTNWWe6a6K5au8/view?usp=sharing">Circular No. 03 Implementation of Standard Procedure for Clarification</option>
                <option value="https://drive.google.com/file/d/1Ryp565IxjUSiFAMM9P1YASyH80oSVcGo/view?usp=sharing">Circular No. 04 Guidelines for Submission of Site Settlements & Labour Bills</option>
                <option value="https://drive.google.com/file/d/1BOLnms67IH6ezbN5hkry7MTaPWA1H_h-/view?usp=sharing">Circular No. 05 Project Site Incharge Role in MEP Works</option>
                <option value="https://drive.google.com/file/d/1Cg0tA7eNFVblnJbW77YeofWcWX-X8du3/view?usp=sharing">Circular No. 06 Mandate to execute works on Measurement Basis</option>
                <option value="https://drive.google.com/file/d/1YhkWC8VggjCefa81oTAcgkZpQ3YVeM7L/view?usp=sharing">Circular No. 07 Appointment of VP Admin and Coordination EPC</option>
                <option value="https://drive.google.com/file/d/1jQKLe0ESBvPnpnQ1lz2qhHmrIa9ietNe/view?usp=sharing">Circular No. 09 Disciplinary Action for Absent Staff</option>
                <option value="https://drive.google.com/file/d/13UMptlmS02PB2QYnW3WTAlJZ5Z1jZJc1/view?usp=sharing">Circular No. 10 Implementation of Revised Workflow</option>
                <option value="https://drive.google.com/file/d/1M24onkvw8u2rjDXR9wUvxtGqm4nEjdtJ/view?usp=sharing">Circular No. 12 Procedure for Deployment of Labours</option>
                <option value="https://drive.google.com/file/d/1iXcMUrkB5M7D65AP2tfvw8GUaNij0rD2/view?usp=sharing">Circular NO. 13 Punching Machine Operations</option>
                <option value="https://drive.google.com/file/d/1TUKHFS1Cv9n-Fxulbi47rIjvi42MjnWt/view?usp=sharing">Circular No. 13 Settlement of Imprest (Petty Cash) Amount</option>
                <option value="https://drive.google.com/file/d/1FFai9jtOomSAJ_ldQbHdZeBAZa_l_BTH/view?usp=sharing">Circular No. 14 Mandatory Site Facilities</option>
                <option value="https://drive.google.com/file/d/1iAg4hmAR1kIJeWfgBNbbSaY03J-EKkqN/view?usp=sharing">Circular No. 15 Maintenance of Shuttering Material Stock Register</option>
                <option value="https://drive.google.com/file/d/1zC68M8ZQxqASA7RMKxQPZPq0em_XC20J/view?usp=sharing">Circular No. 16 Store Audit</option>
                <option value="https://drive.google.com/file/d/11b0fFAlk9-Xu7tGWxgxUpwHenB6fm34V/view?usp=sharing">Circular No. 18 Composition of Techno-Commercial Committee (TCC)</option>
                <option value="https://drive.google.com/file/d/19n98BDp-bnaOzrAQUHi6jhh7CCi_tOnx/view?usp=sharing">Circular No. 19 (Amendment to Circular number 10)</option>
                <option value="https://drive.google.com/file/d/1wZ--8_LI7qtZNFW1hmlMQDJ_8UlMoP-W/view?usp=sharing">Circular No. 20 Online Tracking of Settlement Bills</option>
                <option value="https://drive.google.com/file/d/1dTvDa55FxHfrqwddYH6GP8ljjfyR3d1m/view?usp=sharing">Circular No. 21 Tendering, Client Bill Audit & Contractual</option>
                <option value="https://drive.google.com/file/d/1rO07KIwVKTBii5u8K0f3yt7Cq2hmXyis/view?usp=sharing">Circular No. 22 Guideline for Storage capacity of Diesel</option>
                <option value="https://drive.google.com/file/d/1zPqw0eIyzADlf-Fx6j7JdR82YDBbxLpk/view?usp=sharing">Circular No. 26 Certifiction of EPC-MEP Subcontractors</option>
                <option value="https://drive.google.com/file/d/1UwnpWh8Sy9Glhpiee84IcUydAiXDb1cs/view?usp=sharing">Circular No. 27 Audit of client billing & General site Audit</option>
                <option value="https://drive.google.com/file/d/1PzqSeBkUjLGZ5twvwcdzx85X1CysnIbG/view?usp=sharing">Circular Policy on Vendor - Contractor Advances</option>
                <option value="https://drive.google.com/file/d/1TCiztWEB-X3kMp1wPwLvB3tdVEhqYw64/view?usp=sharing">Circular - Asset Management(1)</option>
            </select>
        </div>
    </div>

    <div id="pdfViewer" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#333; z-index:99999;">
        <div style="width:100%; height:50px; background:#202124; display:flex; justify-content: space-between; align-items:center; padding: 0 20px; box-sizing:border-box; border-bottom: 1px solid #3c4043;">
            <span id="dynamicTitle" style="color:#e8eaed; font-family: Arial; font-size: 14px; font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 60%;">Circular Viewer</span>
            
            <div style="display:flex; align-items:center;">
                <button onclick="printPDF()" title="Print" style="background:none; border:none; cursor:pointer; padding:8px; margin-right:10px;">
                    <svg fill="#e8eaed" height="24" viewBox="0 0 24 24" width="24"><path d="M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"/></svg>
                </button>
                <button onclick="downloadDirect()" title="Download" style="background:none; border:none; cursor:pointer; padding:8px; margin-right:10px;">
                    <svg fill="#e8eaed" height="24" viewBox="0 0 24 24" width="24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                </button>
                <button onclick="closeViewer()" title="Close" style="background:none; border:none; cursor:pointer; padding:8px;">
                    <svg fill="#e8eaed" height="24" viewBox="0 0 24 24" width="24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
        </div>
        
        <div class="iframe-container">
            <div class="iframe-blocker"></div>
            <iframe id="pdfFrame" name="pdfFrame" src="" style="width:100%; height:100%; border:none;"></iframe>
        </div>
    </div>

   <script>
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.onkeydown = function(e) {
        if (e.keyCode == 123 || (e.ctrlKey && (e.shiftKey && (e.keyCode == 73 || e.keyCode == 74 || e.keyCode == 67)) || e.keyCode == 85 || e.keyCode == 83)) return false;
    };

    document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
            const viewer = document.getElementById('pdfViewer');
            if (viewer.style.display === "block") {
                e.preventDefault();
                printPDF();
            }
        }
    });

    function getFileId(url) {
        if (url.includes("/d/")) return url.split('/d/')[1].split('/')[0];
        if (url.includes("id=")) return url.split('id=')[1].split('&')[0];
        return "";
    }

    function closeViewer() {
        document.getElementById('pdfViewer').style.display = "none";
        document.getElementById('pdfFrame').src = "";
        document.getElementById('circular').selectedIndex = 0;
    }

    function downloadDirect() {
        let selectBox = document.getElementById('circular');
        let fileUrl = selectBox.value;
        if (fileUrl !== "") {
            let fileId = getFileId(fileUrl);
            window.location.href = "https://drive.google.com/uc?export=download&id=" + fileId;
        }
    }

    function printPDF() {
        const selectBox = document.getElementById('circular');
        const fileUrl = selectBox.value;
        if (fileUrl && fileUrl !== "") {
            const fileId = getFileId(fileUrl);
            const printUrl = "https://drive.google.com/file/d/" + fileId + "/view";
            const printWindow = window.open(printUrl, '_blank');
            if (printWindow) printWindow.focus();
        }
    }

    function redirectUser() {
        let selectBox = document.getElementById('circular');
        let fileUrl = selectBox.value;
        if (fileUrl === "") return;
        let fileName = selectBox.options[selectBox.selectedIndex].text;
        let fileId = getFileId(fileUrl);
        let previewUrl = "https://drive.google.com/file/d/" + fileId + "/preview?rm=minimal";
        document.getElementById('dynamicTitle').innerText = fileName;
        document.getElementById('pdfFrame').src = previewUrl;
        document.getElementById('pdfViewer').style.display = "block";
    }

    document.addEventListener('DOMContentLoaded', function() {
        const searchWrapper = document.getElementById('searchWrapper');
        const searchIcon = document.getElementById('searchIcon');
        const searchInput = document.getElementById('floatingSearch');
        const suggestionList = document.getElementById('suggestionList');
        const circularSelect = document.getElementById('circular');

        searchIcon.onclick = function() {
            searchWrapper.classList.toggle('search-active');
            if (searchWrapper.classList.contains('search-active')) {
                searchInput.style.display = 'block';
                searchInput.focus();
            } else {
                searchInput.style.display = 'none';
                suggestionList.style.display = 'none';
                searchInput.value = '';
            }
        };

        searchInput.addEventListener('input', function() {
            const filter = this.value.toLowerCase();
            suggestionList.innerHTML = '';
            if (filter === "") { suggestionList.style.display = 'none'; return; }
            const options = Array.from(circularSelect.options).filter(opt => opt.value !== "");
            let matches = options.filter(opt => opt.text.toLowerCase().includes(filter));
            if (matches.length > 0) {
                suggestionList.style.display = 'block';
                matches.forEach(match => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item'; 
                    div.innerText = match.text;
                    div.onclick = function() {
                        circularSelect.value = match.value;
                        redirectUser(); 
                        searchInput.value = '';
                        suggestionList.style.display = 'none';
                        searchWrapper.classList.remove('search-active');
                        searchInput.style.display = 'none';
                    };
                    suggestionList.appendChild(div);
                });
            }
        });
    });
</script>
</body>
</html>
